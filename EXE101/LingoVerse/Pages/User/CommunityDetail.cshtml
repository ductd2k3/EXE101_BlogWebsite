@page
@model LingoVerse.Pages.User.CommunityDetailModel
@{
}
<head>
    <link rel="stylesheet" href="~/css/CommunityDetail.css" asp-append-version="true" />
</head>
<!-- Main Content -->
<div class="container">
    <!-- Post Detail Section -->
    <div class="post-detail">
        <h1>Chi Tiết Bài Đăng</h1>
        <div class="post-content" id="post-content">
            <!-- Nội dung bài đăng sẽ được thêm bằng JS -->
        </div>
        <div class="post-meta" id="post-timestamp">
            <!-- Thời gian đăng sẽ được thêm bằng JS -->
        </div>
    </div>

    <!-- Comments Section -->
    <div class="comments-section">
        <h2><i class="fas fa-comments"></i> Bình luận</h2>
        <textarea class="comment-input" id="comment-input" placeholder="Viết bình luận của bạn..."></textarea>
        <button class="btn btn-comment" id="comment-button">Đăng bình luận</button>
        <div class="comment-list" id="comment-list">
            <!-- Bình luận sẽ được thêm bằng JS -->
        </div>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Lấy dữ liệu bài đăng từ localStorage
        const postData = JSON.parse(localStorage.getItem('selectedPost')) || {
            content: '<p><strong>Hôm nay mình học được một mẹo học từ vựng mới!</strong> Mọi người thử dùng flashcard xem, rất hiệu quả. Mình thường học 10 từ mỗi ngày, còn bạn thì sao? <u>Có ai có cách học nào hay hơn không?</u></p>',
            timestamp: '17/03/2025, 10:30:00'
        };

        // Hiển thị bài đăng
        document.getElementById('post-content').innerHTML = postData.content;
        document.getElementById('post-timestamp').innerHTML = `<i class="far fa-clock"></i> ${postData.timestamp}`;

        // Danh sách bình luận mẫu
        let comments = [
            { text: 'Mình cũng dùng flashcard, nhưng hay quên lắm. Có cách nào nhớ lâu không?', timestamp: '17/03/2025, 11:00:00' },
            { text: 'Cảm ơn mẹo hay! Mình sẽ thử ngay hôm nay.', timestamp: '17/03/2025, 11:15:00' }
        ];

        // Hiển thị bình luận ban đầu
        renderComments();

        // Xử lý đăng bình luận
        document.getElementById('comment-button').addEventListener('click', function () {
            const commentText = document.getElementById('comment-input').value.trim();

            if (!commentText) {
                alert('Vui lòng nhập nội dung bình luận!');
                return;
            }

            const newComment = {
                text: commentText,
                timestamp: new Date().toLocaleString('vi-VN')
            };

            comments.unshift(newComment);
            renderComments();
            document.getElementById('comment-input').value = ''; // Reset textarea
        });

        // Hàm hiển thị bình luận
        function renderComments() {
            const commentList = document.getElementById('comment-list');
            commentList.innerHTML = '';
            comments.forEach(comment => {
                const commentItem = document.createElement('div');
                commentItem.className = 'comment-item';
                commentItem.innerHTML = `
                            <p>${comment.text}</p>
                            <small><i class="far fa-clock"></i> ${comment.timestamp}</small>
                        `;
                commentList.appendChild(commentItem);
            });
        }
    });
</script>